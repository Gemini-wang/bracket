!function(){function a(){function b(a,b,c){if(1==arguments.length)c=arguments[0],b=[],a="";else if(2==arguments.length&&"function"==typeof arguments[1])c=arguments[1],"string"==typeof arguments[0]?(a=arguments[0],b=[]):(b=arguments[0],a="");else if(arguments.length<3)throw Error("invalid arguments");d(c,a,b)}function c(){for(var a,b=!0;b;)if(b=!1,k=k.filter(function(c){if(f(c.requires)){try{e(c.invoke,c.name),b=!0}catch(d){a=d}return!1}return!0}),a)throw a}function d(a,b,d){if(f(d))e(a,b),c();else{var g={invoke:a,requires:d,name:b};b&&(i[b]=g),k.push(g)}}function e(a,b){var c,d,e={},f={};if(!a){if(!(c=i[b]))throw Error("can not find module:"+b);a=c.invoke}if(b){if(l.indexOf(b)>-1)throw Error("circular dependencies:",l.join("->"));l.push(b)}try{return d=a(g,e,f)||f.exports||e}catch(k){throw d=k}finally{c&&delete i[b],b&&(l.splice(l.indexOf(b),1),j.push(b),h[b]=d)}}function f(a){return a.every(function(a){return j.indexOf(a)>-1})}function g(a){return h[a]||e(null,a)}var h={},i={},j=[],k=[],l=[];return b.require=function(a){return h.hasOwnProperty(a)||i.hasOwnProperty(a)?g(a):void 0},b.newContext=a,b.conflict=function(){console.log(k)},b}window.bracket={define:a()}}(),bracket.define("mvc.binding",["mvc.parser"],function(a){function b(a){return this instanceof b?("string"==typeof a&&(a=d.parse(a)),this.expression=a,void(this.$$actions=[])):new b(a)}{var c=a("mvc.util"),d=a("mvc.parser"),e=c.arrAdd;c.isFunc}return b.prototype={get id(){return this.expression.id},update:function(a){var b=this.$$currentValue=this.get(a),d=this.$$lastValue;return c.equals(b,d)||c.objEmit(this,"update",[b,d,a],null),this.$$lastValue=this.$$currentValue},get:function(a){return this.expression.get(a)},addAction:function(a,b){return c.objOn(this,"update",a,b),this},merge:function(a){if(a.id!==this.id)throw Error("cannot merge binding of different ids");var b=this.$$actions;return a.$$actions.forEach(function(a){e(b,a)}),this}},b.global=window,b}),bracket.define("mvc.controller",["mvc.binding"],function(a){function b(a){return this instanceof b?(a=a||{},this.$$bingdings={},this.$$parent=a.parent,this.$$children=[],this.$$root=a.root||this,this.$$phrase="valid",this.$this=this,this.$update(),void d(this)):new b(a)}function c(a){a.$$phrase="updating",h(a.$$bingdings,function(b){b.update(a)}),a.$$children.forEach(c),a.$$phrase="valid"}var d,e=a("mvc.util"),f=a("mvc.binding"),g=e.isFunc,h=e.forEach;b.prototype={$on:function(a,b){return e.objOn(this,a,b)},$upward:function(a,b){var c=this.$$parent;return c&&(e.objEmit(c,a,b),c.$upward(a,b)),this},$broadcast:function(a,b){return this.$$children.forEach(function(c){e.objEmit(c,a,b),c.$broadcast(a,b)}),this},$destroy:function(){var a=this.$$root,b=this.$$parent;"destroyed"!==this.$$phrase&&(b&&(e.arrRemove(b.$$children,this),this.$$parent=null,this.$$phrase="destroyed"),a&&a.$update())},$$new:function(){var a=Object.create(this);return b.call(a,{parent:this,root:this.$$root}),this.$$children.push(a),a},$bind:function(a,b,c){var d;return"string"==typeof a&&(a=new f(a)),d=(d=this.$$bingdings[a.id])?d.merge(a):this.$$bingdings[a.id]=a,d.addAction(b,c),this},$update:function(){if("valid"==this.$$phrase){var a;this.$$phrase="invalid",(a=this.$$root)==this?window.requestAnimationFrame(function(){c(a)}):a&&a.$update()}}};var i="$$phrase";return d=g(Object.observe)?function(a){Object.observe(a,function(b){b.some(function(a){return-1==i.indexOf(a.name)})&&a.$update()})}:function(){},b}),bracket.define("mvc.ast",["mvc.util"],function(a,b){function c(a,b){m.inherit(a,d.prototype,b)}function d(){}function e(a){this.thisObj=a}function f(a){this.value=a}function g(a,b){this.params=b.slice(),this.name=a}function h(a){this.propertyNames=a?a instanceof Array?a.slice():[a]:[]}function i(a){this.asts=a?[a]:[]}function j(a,b,c){this.left=a||new e,this.right=c,this.action=b}function k(a){var b=a.asts=a.asts.map(function(a){return a.reduce()}).filter(function(a){return a}),c=b.length;return c?1==c?b[0]:a:void 0}function l(a){var b=a.right,c=a.left,d=a,g=a.action;return b instanceof j&&(b=l(b)),c instanceof j&&(c=l(c)),"."==g&&(c instanceof h&&b instanceof f?d=new h(c.propertyNames).addProperty(b.value):c instanceof e&&!c.thisObj&&(b instanceof f?d=new h(b.value):b instanceof h&&(d=new h(b.propertyNames)))),d}var m=a("mvc.util"),n=m.isFunc;d.prototype={get:function(){},reduce:function(){return this},operate:function(a,b){return new j(this,a,b)},type:"ast"},c(e,{type:"this",get:function(a){return this.thisObj||a}}),c(f,{get:function(){return this.value},type:"const"}),c(h,{get:function(a){for(var b=a,c=0,d=this.propertyNames,e=d[0];void 0!==e&&void 0!==b&&void 0!==(b=b[e]);e=d[++c]);return b},addProperty:function(a){return this.propertyNames.push(a),this},type:"access"}),c(g,{get:function(a,b){var c,d;if(b=b||a,n(c=b[this.name]))try{d=c.apply(b,this.params.map(function(b){return b.get(a)}))}catch(e){d=e}return d},type:"invoke"}),c(j,{type:"binary",get:function(a){var b,c,d=this.left.get(a);if(void 0!==d){if("call"===(c=this.action))return this.right.get(a,d);if(b=this.right.get(a))switch(c){case".":return d[b];case"+":return d+b;case"-":return d-b;case"*":return d*b;case"/":return d/b;default:throw Error("unsupported action")}}},reduce:function(){return l(this)}}),c(i,{add:function(a){return(a=a.reduce())&&this.asts.push(a),this},get:function(a){return this.asts.reduce(function(b,c){return c.get(a)})},reduce:function(){return k(this)}}),b.Ast=d,b.This=e,b.Binary=j,b.Const=f,b.Invoke=g,b.Access=h,b.Statement=i}),bracket.define("mvc.compile",["mvc.register"],function(a,b){function c(a,b){function h(b){var c=b.name;k.hasOwnProperty(c)&&(b.link(j,a,k),delete b[c])}var j,k=e.attrMap(a);return(j=d(k.bracketController,b)||b)&&(i.forEach(h),g(j,a,k)),f.mkArr(a.children).forEach(function(a){c(a,j)}),{controller:j,element:a,attributes:k}}function d(b,c){var d,e,f;if(b&&(f=b.value)){if(d=a(f),!h(d))throw Error("controller must be a function");d.call(e=c.$$new(),e)}return e}var e=a("mvc.dom"),f=a("mvc.util"),g=a("mvc.interpolate").interpolateElement,h=f.isFunc,i=a("mvc.register").compilers;b.compile=c}),bracket.define("mvc.debug",function(a,b,c){var d=!1;c.exports={enable:function(a){return d=a!==!1},stop:function(){},error:function(a){throw a}}}),bracket.define(["mvc.register"],function(a){a("mvc.register").addCompiler({name:"bracket-class",link:function(a,b,c){a.$bind(c.bracketClass.value,function(a,c){c&&b.classList.remove(c),a&&b.classList.add(a)})}}),a("mvc.register").addCompiler({name:"bracket-src",link:function(a,b,c){a.$bind(c.bracketSrc.value,function(a){a&&b.setAttribute("src",a)})}})}),bracket.define(["mvc.register"],function(a){function b(a){return a[0].toUpperCase()+a.slice(1)}function c(a){e({name:"bracket-"+a,link:function(c,d,e){function g(a){c.$event=a,h.get(c),c.$event=null,c.$update()}try{var h=f(e["bracket"+b(a)].value);d.addEventListener(a,g)}catch(i){console.error(i)}}})}var d=a("mvc.util"),e=(d.isFunc,a("mvc.register").addCompiler),f=a("mvc.parser").parse;"click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" ").forEach(function(a){c(a,!0)})}),bracket.define(["mvc.compile"],function(a){function b(a,b,c){var d,e,f=a.parentElement,g=a;for(d=b.length-1;d>=0;d--)f.contains(e=b[d])||f.insertBefore(e,g),g=e;c&&c.forEach(function(a){a&&f.removeChild(a)})}function c(a,b){var c,d=a.parentElement;return d.insertBefore(document.createComment("bracket-repeat "+b),a),d.insertBefore(c=document.createComment("bracket-repeat end"),a.nextSibling),c}var d=a("mvc.compile"),e=a("mvc.util"),f=a("mvc.dom");a("mvc.register").addCompiler({name:"bracket-repeat",priority:1e3,link:function(a,g,h){var i=h.bracketRepeat.value,j=i.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!j)throw Error("repeat exp should like: item in items (track by item.id)");var k=c(g,i),l=g.cloneNode(!0);f.removeAttribute(l,"bracket-repeat"),g.parentElement.removeChild(g);var m=j[2],n=j[1],o=(j[3],{}),p=[];a.$bind(m,function(c){c=e.mkArr(c)||[];var f,g={},h=c.map(function(b,c){if((f=o[c])&&f.model===b)e=f,p[c]=void 0;else{var e=d.compile(l.cloneNode(!0),a.$$new()),h=e.controller;h[n]||(h[n]=b),g[h.$index=c]={element:e.element,controller:e.controller,model:b},f&&f.controller.$destroy()}return e.element});o=g,b(k,h,p),p=h})}})}),bracket.define("mvc.dom",["mvc.util"],function(a){function b(a){return a.toLowerCase().replace(/^data\-/,"").replace(/\-[a-z]/g,function(a){return a[1].toUpperCase()})}function c(a){return g.arrReduce(a.attributes,function(a,c){return a[b(c.name)]=c,a},{})}function d(a,b){return g.mkArr((b||document).querySelectorAll(a))}function e(a){return[a,"data-"+a]}function f(a,b,c){for(var d,f=e(b),g=0,h=c?f.length:1;h>g;g++)if(null!==(d=a.getAttribute(f[g])))return d;return null}var g=a("mvc.util"),h=Node.TEXT_NODE;return{$:d,getAttr:f,removeAttribute:function(a,b){e(b).some(function(b){return a.hasAttribute(b)?(a.removeAttribute(b),!0):void 0})},attrMap:c,normalize:b,textNodes:function(a){return g.arrFilter(a.childNodes,function(a){return a.nodeType===h})}}}),bracket.define("mvc.interpolate",["mvc.controller","mvc.dom"],function(a,b){function c(a){var b={};return a.replace(g,function(a,c,d){b[a]={once:!!c,expression:d}}),b}var d=a("mvc.binding"),e=a("mvc.util").forEach,f=a("mvc.dom").textNodes,g=/\{\{(::)?(.*?)\}\}/g;b.getBinding=function(a){var b,c=a;return a.replace(g,function(a,d){b=c=d}),d(c)},b.interpolateElement=function(a,b,d){function h(b,d){var f=b[d];g.test(f)&&e(c(f),function(c,e){a.$bind(c.expression,function(a){void 0!==a&&(b[d]=f.split(e).join(a))},c.once)})}e(d,function(a){h(a,"value")}),f(b).forEach(function(a){h(a,"textContent")})}}),bracket.define("bracket.mvc",["mvc.compile","mvc.dom"],function(a){function b(a,b){var e,h=f.$('*[bracket-app="!"]'.replace("!",a))[0];h?(c(a,{require:j(h,"bracket-require",1)}),e=n[a].require,f.$("*[bracket-controller]",h).forEach(function(a){d(e,j(a,"bracket-controller"))}),l(e.slice(),function(){var a=k(h,new m);g.isFunc(b)&&b(a)})):console.warn("element with bracket-app="+a+" not found")}function c(a,b){var c=e(a);return c&&b&&d(c.require,b.require),c}function d(a,b){return a&&("string"==typeof b&&(b=b.split(/\b\s+\b/).map(i)),b instanceof Array&&b.forEach(function(b){h(a,b)})),a}function e(a){if(a){var b=n[a];return b||(b=n[a]={require:[]}),b}}var f=a("mvc.dom"),g=a("mvc.util"),h=g.arrAdd,i=a("mvc.parser").trim,j=f.getAttr,k=a("mvc.compile").compile,l=bracket.define,m=a("mvc.controller"),n={};return bracket.mvc={init:b,configApp:c}}),bracket.define("mvc.parser",["mvc.ast"],function(a,b){function c(a){function b(){return a=a.replace(j,"")}function c(){return(r=a.match(k))&&(s=r[0])}function d(){switch(s){case"false":return!1;case"true":return!0;case"null":return null;case"undefined":return void 0;default:throw""}}function e(){return(r=a.match(m))&&(s=r[0])}function f(){return(r=a.match(l))&&(s=r[0])}function g(){return(r=a.match(n))&&(s=r[0])}function h(){return i.indexOf(a[0])>-1&&!/^\.\d/.test(a)&&(s=a[0])}function p(b,c,d){u.push({type:b,value:c,index:t-a.length}),a=a.replace(d||c,"")}for(var r,s,t=a.length,u=[];b();)if(g())p(o["const"],s.substring(1,s.length-1),s);else if(c())p(o["const"],d(),s);else if(f())p(o["const"],+s,s);else if(e())p(o.id,s);else{if(!h())throw Error("unsupported string:"+a+" in "+q);p(";"==s?o.end:o.punc,s)}return u}function d(a){throw Error("parse error:"+q+" ; at:"+a)}function e(a){var b=c(q=a);return f(b)}function f(a){function b(){switch(p.type){case o.punc:case o.end:"."==s?h():";"==s?j():"("==s?n(e("(",")")):"["==s?m(e("[","]",1)):d(p.index);break;case o["const"]:i(1);break;case o.id:k();break;default:d(p.index)}}function c(a,b){return v=v.operate(a,b).reduce()}function e(b,c,e,f){var g,h=[],i=1;f=f||a;for(var j=0,k=f.length;k>j&&0!=i;j++){if((g=f.shift()).value==b?i++:g.value==c&&i--,0==i)return e&&0==h.length?d(g.index):h;h.push(g)}throw Error("expect "+c+"after: "+q.substring(g.index-10,g.index))}function h(){var a=u.length;a>1?d(p.index):1==a&&c(".",new g.Const(u.pop().value))}function i(a){a&&u.length&&d(p.index),j(),v=new g.Const(p.value)}function j(){return h(),v instanceof g.This||t.add(v),v=new g.This}function k(){u.push(r=p)}function l(){return(p=a.shift())?(s=p.value,!0):!1}function m(a){h(),c(".",f(a))}function n(a){for(var b,d,h,i=[],j=0,k=0,l=a.length;l>k;k++)","==(d=a[k].value)?(i.push(f(a.slice(j,k))),j=k+1):"("==d&&(h=e("(",")",0,a.slice(k+1)),i.push(f(a.slice(k-1,j=h.length+k+2))),k=j);return(b=a.slice(j)).length&&i.push(f(b)),c("call",new g.Invoke(u.pop().value,i))}for(var p,r,s,t=new g.Statement,u=[],v=new g.This;l();)b();return j(),t.reduce()}var g=a("mvc.ast"),h=a("mvc.util").uid,i=".[]();'\",",j=/^[\s\t\r\n\f]+/,k=/^(ture|false|null|undefined)/,l=/^(\d+|\d*\.\d+)/,m=/^[a-z_$][a-z0-9_$]*/i,n=/^('|").*?\1/,o={"const":1,punc:2,id:3,end:4},p={};b.token=c,b.parse=function(a,b){var c;return a=a.trim(),(b||!(c=p[a]))&&(c=e(a)),b||(p[a]=c),c.id=h("expression"),c};var q}),bracket.define("mvc.register",["mvc.interpolate"],function(a,b,c){function d(a){var b=h.normalize(a.name);f.arrInsert(i,{priority:a.priority||0,name:b,link:g(a.link)?a.link:e},"priority")}function e(){}var f=a("mvc.util"),g=f.isFunc,h=a("mvc.dom"),i=[];c.exports={addCompiler:d,compilers:i}}),bracket.define("mvc.util",["mvc.debug"],function(a,b,c){function d(a,b,c){var d,e=0;if(f(a))if(void 0===c&&(c=a),a instanceof Array)a.forEach(b,c);else if(d=a.length)for(;d>e;e++)b.call(c,a[e],e);else for(var g=Object.getOwnPropertyNames(a),h=g[0];h;h=g[++e])b.call(c,a[h],h);return a}function e(a){return"function"==typeof a}function f(a){return a&&"object"==typeof a}function g(a,b,c,e){"function"==typeof b&&(b=new b),b=b||{};var f,g=a.prototype=Object.create(b);if(c)for(var h in c)f=Object.getOwnPropertyDescriptor(c,h),f?Object.defineProperty(g,h,f):g[h]=c[h];return e&&d(e,function(a,b){Object.defineProperty(g,a,b)}),a}function h(a,b,c){return-1==a.indexOf(b)?(a[c?"unshift":"push"](b),!0):void 0}function i(a,b,c,d){if("string"==typeof b&&b&&e(c)){var f,g;return a.hasOwnProperty("$$callbacks")||(a.$$callbacks={}),f=a.$$callbacks,(g=f[b])||(g=f[b]=[]),h(g,d?l(c):c)}return!1}function j(a,b,c,d){var f,g;return a.hasOwnProperty("$$callbacks")&&(g=(f=a.$$callbacks)[b])?(c?c instanceof Array||(c=[c]):c=[],void 0===d&&(d=a),f[b]=g.reduce(function(a,b){return e(b)&&-1!==b.apply(d,c)&&a.push(b),a},[])):!1}function k(a,b,c){var d,e,f;return void 0===b?a.$$callbacks={}:(d=a.$$callbacks)&&(e=d[b])&&e&&(c?(f=e.indexOf(c))>-1&&(e[f]=null):d[b]=[]),a}function l(a){return function(){return a.apply(this,arguments),-1}}function m(a){var b=typeof a;return"string"===b?function(b){return b[a]}:"function"===b?a:function(a){return a}}function n(a,b,c,d,e){function f(a){return b==c(a)}function g(a){return b===c(a)}return c=m(c),q(a).some(d?f:g,e)}function o(a,b,c){var d,e;return q(a).some(function(a,c){return b(a)?(d=a,e=c,!0):void 0},c)?{index:e,value:d}:void 0}function p(a,b,c,d){function e(a){return h<c(a)}function f(a){return h>c(a)}var g,h=(c=m(c))(b),i=-1;return(g=o(a,d?f:e))?a.splice(i=g.index,0,b):t(a)&&-1!=a.indexOf(b)||(a[i=a.length]=b),i}function q(a){return t(a)?a:s.slice.call(a)}function r(a){return u[a]=u[a]?++u[a]:1}var s=[],t=Array.isArray,u={};c.exports={inherit:g,forEach:d,isObj:f,isFunc:e,arrAdd:h,objOn:i,objOff:k,objEmit:j,arrHas:n,arrInsert:p,arrFirst:o,uid:r,arrRemove:function(a,b,c){var d;do{if(!((d=a.indexOf(b))>-1))break;a.splice(d,1)}while(c)},equals:function(a,b){if(a===b){var c=typeof a;return"string"===c||"number"===c}return!1},empty:function(a){return!!a&&0==Object.getOwnPropertyNames(a).length},mkArr:q},d(Array.prototype,function(a,b){var d;e(a)&&(d="arr"+b[0].toUpperCase()+b.slice(1),c.exports[d]=function(){return a.apply(arguments[0],s.slice.apply(arguments,[1]))})})});